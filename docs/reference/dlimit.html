<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Impute Detection Limits — dlimit • baytrends</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Impute Detection Limits — dlimit" />
<meta property="og:description" content="Imputes values for missing detection limits for left-censored data.  From smwrQW package." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">baytrends</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/create_Seasonally_Detrended_Flow_and_Salinity_Data_Sets.html">Vignette, Create Seasonally Detrended Flow and Salinity Data Sets</a>
    </li>
    <li>
      <a href="../articles/vignette_qw.html">Vignette, QW</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/tetratech/baytrends">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Impute Detection Limits</h1>
    <small class="dont-index">Source: <a href='https://github.com/tetratech/baytrends/blob/master/R/smwrQW_x_dlimit.R'><code>R/smwrQW_x_dlimit.R</code></a></small>
    <div class="hidden name"><code>dlimit.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Imputes values for missing detection limits for left-censored data.  From smwrQW package.</p>
    </div>

    <pre class="usage"><span class='fu'>dlimit</span>(<span class='no'>values</span>, <span class='no'>censor.codes</span>, <span class='kw'>default</span> <span class='kw'>=</span> <span class='fl'>1e-25</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>values</th>
      <td><p>the numeric values.</p></td>
    </tr>
    <tr>
      <th>censor.codes</th>
      <td><p>logical or character, <code>TRUE</code> or "&lt;" indicates
left-censored at value and <code>FALSE</code>, " " or "" indicates a quantified
value. Character codes "E" and "J" are censored at the current detection
limit. Other characters are ignored and generate a warning.</p></td>
    </tr>
    <tr>
      <th>default</th>
      <td><p>the default detection limit value to assign to an uncensored
value that is less than the currently imputed detection limit value.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A vector of detection limits matched with each of the input values.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This function is based on the DLIMIT function in LOADEST (Runkel and
others, 2004). The general assumption for imputing detection limits is that
the data are sorted by time and the detection limits changes in a consistent
pattern over time.</p>
    <h2 class="hasAnchor" id="warning"><a class="anchor" href="#warning"></a>Warning</h2>

    <p>Tim Cohn, written communication, 5 Nov 2002 states that
there are several problems with this approach:<br /></p>
<p>1) for large data sets, it may be difficult for the user to group the
observations into subsets as in the example above.  If the observations are
not grouped into subsets or the subsets do not have the censored observations
as the first records, incorrect detection limits may be applied to the
uncensored data.<br /></p>
<p>2) for the case of multiple constituents, it may be impossible to place the
censored observation within each subset at the top of the subset.  Consider
constituents Y and Z, each analyzed at Lab B, and each with one censored
observation.  The censored observations occur on different dates.  In this
case its not possible to have both observations as the first line in the
subset from Lab B. (Note: the user could work around this problem by doing
seperate runs for each constituent.)<br /></p>
<p>3) When a subset of observations is completely uncensored, the detection
limit from another subset will be applied.  Consider the example above, but
with the 10 observations from Lab B being completely uncensored.  In this
case, the detection limit from Lab A will be used for all 20 observations.<br /></p>
<p>4) When all of the observations are uncensored (no '&lt;' signs for a given
constituent), there is no way for the user to specify the detection limit(s).
In this case, a default value of 1.E-25 is used for all observations
(consistent with ESTIMATOR).<br /></p>
<p>Despite these problems, the approach is satisfactory for most applications:
"the estimates are not very sensitive to the precise value of the censoring
threshold for the above-threshold values."</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Runkel, R.L., Crawford, C.G., and Cohn, T.A., 2004, Load
estimator (LOADEST) a FORTRAN program for estiamting constituent laods in
streams and rivers: U.S. Gelogical Survey Techniques and Methods 4-A5, 69.
Available online as <a href='https://pubs.er.usgs.gov/publication/tm4A5'>https://pubs.er.usgs.gov/publication/tm4A5</a>.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='readNWQLdl.html'>readNWQLdl</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>
<span class='co'>## The actual detection limits are 2,2,2,1,1,1.</span>
<span class='fu'>dlimit</span>(<span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>,<span class='fl'>2</span>,<span class='fl'>3</span>,<span class='fl'>1</span>,<span class='fl'>1</span>,<span class='fl'>2</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>" "</span>, <span class='st'>"&lt;"</span>, <span class='st'>" "</span>, <span class='st'>" "</span>, <span class='st'>"&lt;"</span>, <span class='st'>" "</span>))</div><div class='output co'>#&gt; [1] 2e+00 2e+00 2e+00 1e-25 1e+00 1e+00</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#warning">Warning</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Erik Leppo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


